"use strict";angular.module("ui.sortable",[]).value("uiSortableConfig",{}).directive("uiSortable",["uiSortableConfig","$timeout","$log",function(e,t,n){return{require:"?ngModel",link:function(o,i,l,a){function r(e,t){return t&&"function"==typeof t?function(n,o){e(n,o),t(n,o)}:e}var c,s={},u={receive:null,remove:null,start:null,stop:null,update:null};angular.extend(s,e),a?(o.$watch(l.ngModel+".length",function(){t(function(){i.sortable("refresh")})}),u.start=function(e,t){t.item.sortable={index:t.item.index(),cancel:function(){t.item.sortable._isCanceled=!0},isCanceled:function(){return t.item.sortable._isCanceled},_isCanceled:!1}},u.activate=function(){c=i.contents();var e=i.sortable("option","placeholder");if(e&&e.element&&"function"==typeof e.element){var t=e.element();t.jquery||(t=angular.element(t));var n=i.find('[class="'+t.attr("class")+'"]');c=c.not(n)}},u.update=function(e,t){t.item.sortable.received||(t.item.sortable.dropindex=t.item.index(),t.item.sortable.droptarget=t.item.parent(),i.sortable("cancel")),"clone"===i.sortable("option","helper")&&(c=c.not(c.last())),c.appendTo(i),t.item.sortable.received&&!t.item.sortable.isCanceled()&&o.$apply(function(){a.$modelValue.splice(t.item.sortable.dropindex,0,t.item.sortable.moved)})},u.stop=function(e,t){!t.item.sortable.received&&"dropindex"in t.item.sortable&&!t.item.sortable.isCanceled()?o.$apply(function(){a.$modelValue.splice(t.item.sortable.dropindex,0,a.$modelValue.splice(t.item.sortable.index,1)[0])}):"dropindex"in t.item.sortable&&!t.item.sortable.isCanceled()||"clone"===i.sortable("option","helper")||c.appendTo(i)},u.receive=function(e,t){t.item.sortable.received=!0},u.remove=function(e,t){t.item.sortable.isCanceled()||o.$apply(function(){t.item.sortable.moved=a.$modelValue.splice(t.item.sortable.index,1)[0]})},o.$watch(l.uiSortable,function(e){angular.forEach(e,function(e,t){u[t]&&("stop"===t&&(e=r(e,function(){o.$apply()})),e=r(u[t],e)),i.sortable("option",t,e)})},!0),angular.forEach(u,function(e,t){s[t]=r(e,s[t])})):n.info("ui.sortable: ngModel not provided!",i),i.sortable(s)}}}]);